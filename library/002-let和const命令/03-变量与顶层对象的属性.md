# 变量与顶层对象的属性
### 顶层对象在各种环境
顶层对象，在浏览器环境中指的是`window`对象，在Node中指的是`global`对象。在ES5中，顶层对象的属性与全局变量是等价。
```javascript
var num = 10;
alert(window.num); //10

val = 99;
alert(window.val); //99

window.num = 100;
alert(num); //100
```
从上面的代码中可以发现，声明的变量与顶层对象的属性是指同一个事情。这样有几点不好的地方：
- 任何一个地方都可以读写顶层对象的属性
- window对象表示实体对象--浏览器对象
- 一不小心就会创建一个全局变量

### ES6变量脱离顶层对象
ES6改变了这一点，保持兼容 var关键字和function关键字声明的全局变量，依旧是window对象的属性；而let、const、class命令声明的全局变量，不再属于顶层对象的属性。也就是说ES6中全局变量将与顶层对象window脱离关系。
```javascript
var n = 1;
alert(window.n); //1

let k = 2;
alert(window.k); //undefined let声明的变量不再是window对象的属性
alert(k); //2
```
### 顶层对象
ES5的顶层对象有点问题，它在各种实现中不统一。
- 浏览器，顶层对象`window`，Node和Web Worker没有`window`
- 浏览器和Web Worker里面，`self`也指向顶层对象，但是Node中没有`self`
- Node里面的顶层对象是`global`，但其他环节都不支持

同一段代码为了能够在各种环境中，都能取得顶层对象。
```javascript
var g;
if (typeof window !== "undefined") {
    g = window;
} else if (typeof global !== "undefined") {
    g = global;
} else if (typeof self !== "undefined") {
    g = self;
} else {
    g = this;
}
g //当前环境全局对象
```
